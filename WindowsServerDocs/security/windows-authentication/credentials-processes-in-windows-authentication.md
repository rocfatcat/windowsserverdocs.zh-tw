---
title: "在 Windows 驗證認證處理程序"
description: "Windows Server 安全性"
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: security-windows-auth
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 48c60816-fb8b-447c-9c8e-800c2e05b14f
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/12/2016
ms.openlocfilehash: 52d50a1bb6bfbe9d35146f362a2a5184df0a6504
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/12/2017
---
# <a name="credentials-processes-in-windows-authentication"></a>在 Windows 驗證認證處理程序

>適用於：Windows Server（以每年次管道）、Windows Server 2016

這適用於 IT 專業人員的參考主題描述 Windows 驗證憑證的處理方式。

Windows 認證管理是作業系統接收服務或使用者的認證並保護未來簡報驗證目標該資訊的程序。 加入網域的電腦，在驗證目標是網域控制站。 驗證中使用的憑證的數位相關聯的使用者身分某種類型的真確性，例如 PIN、密碼或憑證證明文件。

根據預設，Windows 認證驗證對安全性帳號 Manager（坡）資料庫在本機電腦上，或根據 Active Directory 加入網域的電腦上，透過 Winlogon 服務。 登入的使用者介面或應用程式介面 (API) 呈現驗證目標透過程式設計方式，會收集使用者輸入認證。

本機安全性資訊會儲存在下**HKEY_LOCAL_MACHINE\SECURITY**。 儲存的資訊包括原則設定、預設安全性值和 account 資訊，例如快取登入認證。 雖然防也，儲存一份坡資料庫。

下圖顯示所需的元件和路徑認證需要透過系統驗證程序成功登入的使用者。

![圖表顯示所需的元件和認證需要透過系統驗證使用者或成功登入程序的路徑。](../media/credentials-processes-in-windows-authentication/AuthN_LSA_Architecture_Client.gif)

下表描述管理認證登入在此驗證程序中的每個元件。

**適用於所有系統驗證元件**

|Component|描述|
|-------|--------|
|使用者登入|Winlogon.exe 是可執行檔負責管理安全的使用者互動。 Winlogon 服務會透過收集使用者動作安全桌面上 (登入 UI) 到本機安全性授權單位 (LSA) Secur32.dll 透過認證起始 Windows 作業系統的登入程序。|
|應用程式登入|應用程式或服務登入不需要互動式登入。 使用者模式在執行利用 Secur32.dll 而處理程序車載機起始開機的服務，例如在執行利用 Ksecdd.sys 核心模式使用者車載機起始大部分的處理程序。<br /><br />如需有關使用者模式核心模式，查看 [應用程式及使用者模式或服務核心模式本主題中。|
|Secur32.dll|多個驗證的提供者從驗證的基本知識處理。|
|Lsasrv.dll|LSA 伺服器服務，同時執行的安全性原則，做為 LSA 的安全性封裝管理員。 LSA 包含交涉函式，選取 [NTLM] 或 [Kerberos 通訊協定之後判斷哪一個通訊協定已成功。|
|安全性支援提供者|一組排列可以叫用一或多個驗證通訊協定的提供者。 預設設定的提供者可以變更的每個版本的 Windows 作業系統，可以撰寫自訂提供者。|
|Netlogon.dll|網路登入服務執行的服務如下：<br /><br />-維護電腦的安全通道（不會與 Schannel 混淆）為網域控制站。<br />-透過安全的頻道的使用者的認證通過網域控制站並傳回網域安全性識別碼 (Sid) 和使用者權利。<br />-發行服務資源記錄網域名稱系統」(DNS) 中，使用 DNS 名稱解析為網域控制站的網際網路通訊協定」(IP) 位址。<br />-實作複寫通訊協定根據遠端程序呼叫 (RPC) 上同步處理主要網域控制站 (Pdc) 與備份網域控制站 (Bdc)。|
|Samsrv.dll|安全性帳號 Manager（坡），會儲存在本機安全性帳號，執行儲存在本機原則和支援的 Api。|
|登錄|登錄包含了一份坡資料庫、本機安全性原則設定，預設安全性值和 account 資訊，只系統的存取。|

此主題可包含下列區段：

-   [輸入認證使用者登入](#BKMK_CrentialInputForUserLogon)

-   [輸入應用程式與服務登入認證](#BKMK_CredentialInputForApplicationAndServiceLogon)

-   [本機安全性授權](#BKMK_LSA)

-   [快取的認證與驗證](#BKMK_CachedCredentialsAndValidation)

-   [憑證存放區與驗證](#BKMK_CredentialStorageAndValidation)

-   [安全性帳號管理員資料庫](#BKMK_SAM)

-   [本機網域和受信任的網域](#BKMK_LocalDomainsAndTrustedDomains)

-   [在 Windows 驗證憑證](#BKMK_CertificatesInWindowsAuthentication)

## <a name="BKMK_CrentialInputForUserLogon"></a>輸入認證使用者登入
在 Windows Server 2008 和 Windows Vista，圖形驗證，驗證 (GINA) 架構已經取代認證的提供者型號的進行可能列舉其他登入類型登入磚關聯。 這兩個模型如下所述。

**圖形驗證，驗證架構**

圖形驗證，驗證 (GINA) 架構適用於 Windows Server 2003、Microsoft Windows 2000 Server、Windows XP 和 Windows 2000 專業版的作業系統。 這些系統互動式登入的每個工作階段建立 Winlogon 服務的另一個執行個體。 GINA 架構載入 Winlogon 所使用的程序空間，接收處理認證，並透過 LSALogonUser 驗證介面呼叫。

執行個體 Winlogon 執行中工作階段 0 互動式登入。 0 工作階段主機系統服務和其他重要的程序，包括本機安全性授權單位 (LSA) 處理程序。

下圖顯示 credential 程序適用於 Windows Server 2003、Microsoft Windows 2000 Server、Windows XP、與 Microsoft Windows 2000 專業版。

![圖表顯示 credential 程序適用於 Windows Server 2003、Microsoft Windows 2000 Server、Windows XP、與 Microsoft Windows 2000 專業版](../media/credentials-processes-in-windows-authentication/AuthN_GINA_Architecture.gif)

**認證提供者架構**

這些版本中指定認證提供者架構適用於**適用於**清單中的開頭本主題。 在這些系統中，輸入的認證架構延伸設計使用變更認證提供者。 這些提供者會以允許許多登入案例-的相同使用者和不同的驗證方法、密碼，生物智慧卡，例如不同的帳號其他登入磚安全桌面上。

Credential 提供者架構 Winlogon 永遠開始 UI 登入後收到的安全注意順序事件。 登入 UI 查詢提供者已列舉 credential 不同類型的每個 credential 提供的者。 認證提供者已為預設值來指定這些磚的其中一個選項。 所有的提供者已列舉他們的磚之後，登入 UI 它們向使用者顯示。 使用者提供的認證磚進行互動。 登入 UI 送出驗證這些的認證。

認證提供者未執法機制。 它們用來收集和序列化認證。 本機安全性授權，並驗證套件執行的安全性。

認證提供者會在電腦上進行登記與負責下列：

-   請描述驗證所需資訊。

-   處理通訊和邏輯外部驗證授權單位。

-   封裝認證互動式和網路登入。

封裝認證互動式和網路登入包含序列化的程序。 序列化認證登入的多個磚可顯示 UI 登入。 因此，您的組織，可以控制登入畫面，例如使用者登入的目標系統、前登入的存取權的網路及工作站鎖定日解除鎖定原則-關聯自訂的認證提供者。 多個 credential 提供者可以同時存在相同的電腦上。

為標準認證提供者或前 Logon 存取提供者可以開發單一登入 (SSO) 提供者。

每個版本的 Windows 會包含一個預設認證提供者和一個預設前-Logon 存取提供者 (PLAP)，也就是 SSO 提供者。 SSO 提供者可讓使用者進行之前，請先登入本機電腦連接到網路。 這個提供者實作時，提供者會列舉登入 UI 上的磚。

適用於下列案例中 SSO 提供者：

-   **網路驗證及電腦的登入是由不同 credential 提供者來處理。** 本案例變化包括：

    -   使用者之前，請先登入電腦已連接到連接到 virtual 私人網路 (VPN)，例如網路的選項，但不是一定要進行此連接。

    -   網路驗證，才能取得互動式本機電腦上進行驗證時使用的資訊。

    -   多個網路驗證後面其中其他的案例。 例如，使用者驗證網際網路服務提供者 (ISP)、vpn、驗證，然後使用其使用者 account 認證登入本機。

    -   停用快取的憑證，並遠端存取服務需要有連接 VPN 透過在本機登入前驗證使用者。

    -   使用者網域不已經加入網域的電腦上設定本機帳號，必須連接遠端存取服務透過 VPN 連接之前完成互動式登入。

-   **網路驗證及電腦的登入被處理相同 credential 提供者。** 在本案例中，使用者會需要連上網路之前，請先登入電腦。

**登入磚列舉**

認證提供者列舉登入磚中的下執行個體：

-   這些作業系統中指定的**適用於**清單中的開頭本主題。

-   認證提供者列舉工作站登入的磚。 認證提供者通常會序列化認證驗證到本機安全性授權單位。 此程序會顯示每個使用者的目標系統針對每個使用者及特定的磚。

-   登入和驗證架構可讓使用者使用列舉認證者磚以解除鎖定工作站。 通常是目前登入的使用者的預設磚，但如果多個使用者登入，會顯示很多的磚。

-   認證提供者列舉回應使用者要求變更他們的密碼或其他私人資訊，例如釘選的磚。 目前登入的使用者通常是預設磚。不過，如果多位使用者登入，會顯示很多的磚。

-   認證提供者列舉根據序列化憑證以用於驗證遠端電腦上的磚。 認證 UI 未使用相同的執行個體的提供者的登入 UI、解除鎖定工作站或變更密碼。 因此，無法在執行個體的認證 UI 之間的提供者維護狀態的資訊。 這個結構會導致每個遠端電腦登入，假設正確序列化認證一個磚。 本案例也會使用中的使用者 Account 控制項 (UAC)，這可以協助防止未經授權的變更電腦的使用者的授權或系統管理員密碼提示才允許的動作，也可能影響電腦操作，或變更可能影響電腦上的其他使用者的設定。

下圖顯示作業系統中指定的認證程序**適用於**清單中的開頭本主題。

![圖表顯示作業系統中指定的認證程序 * * 適用於 * * 清單本主題的開頭](../media/credentials-processes-in-windows-authentication/AuthN_CredMan_CredProv.gif)

## <a name="BKMK_CredentialInputForApplicationAndServiceLogon"></a>輸入應用程式與服務登入認證
Windows 驗證的設計可以管理認證的應用程式或服務，不需要與使用者互動。 使用者模式中的應用程式是則有哪些系統資源其所存取，而服務可不受限制存取的系統記憶體和外部裝置。

系統服務及傳輸層級應用程式存取透過安全性支援提供者介面 (SSPI) 在 Windows 中提供給列舉適用於系統的安全性套件，選取套件，並使用該套件取得驗證的連接函式的安全性支援提供者 (SSP)。

當 client/伺服器連接驗證：

-   連接 client 端的應用程式認證伺服器使用傳送 SSPI 函式`InitializeSecurityContext (General)`。

-   伺服器端的應用程式連接的回應 SSPI 函式的`AcceptSecurityContext (General)`。

-   SSPI 函式`InitializeSecurityContext (General)`與`AcceptSecurityContext (General)`直到您需要驗證訊息有已成功或失敗驗證換貨的重複。

-   已經過驗證連接之後，在伺服器上的 LSA 會使用 client 的資訊來建置安全性操作，其中包含存取預付碼。

-   然後伺服器撥打電話 SSPI 函式`ImpersonateSecurityContext`服務模擬執行緒連接存取預付碼。

**應用程式和使用者模式**

在 Windows 中的使用者模式由兩個系統傳遞 I/O 要求適當核心模式驅動程式的能力所組成：環境系統中，執行許多不同類型的作業系統撰寫應用程式，並不可或缺的系統代表環境系統系統特定功能的運作方式。

不可或缺的系統管理代表環境系統作業 system'specific 功能，並包含安全性系統處理程序所以無法、工作站服務，以及伺服器服務。 安全性系統處理程序獨享優惠安全性權杖、授與或拒絕帳號根據資源」權限的存取權限，處理登入要求起始登入驗證，並判斷需要稽核作業系統的系統資源。

應用程式可執行的使用者模式可執行應用程式為任何原則，包括安全性層級本機系統（系統）。 應用程式也可以執行核心模式位置的應用程式可以執行的安全性層級本機系統（系統）。

SSPI 可透過 Secur32.dll 模組，也就是用來取得整合式的安全性驗證、訊息完整性和訊息隱私權服務 API。 它可以提供應用程式層級通訊協定的安全性通訊協定之間抽象層級。 不同的應用程式要求的認證或驗證使用者與不同的網路上的資料加密的方式不同的方式，因為 SSPI 提供方式存取動態連結媒體櫃 (Dll) 包含不同的驗證並密碼編譯函數。 這些 Dll 稱為安全性支援提供者（層）。

管理服務帳號及 virtual 帳號帶來 Windows Server 2008 R2 和提供重要的應用程式，例如 Microsoft SQL Server 和網際網路資訊服務 (IIS)，以他們自己的網域帳號的隔離的 Windows 7 時手動不需要系統管理員可以管理這些帳號認證與服務主體名稱 (SPN)。 如需有關這些功能，而且在驗證中的角色，請查看[管理服務帳號文件，適用於 Windows 7 和 Windows Server 2008 R2](https://technet.microsoft.com/library/ff641731(v=ws.10).aspx)和[群組管理服務帳號概觀](../group-managed-service-accounts/group-managed-service-accounts-overview.md)。

**服務及核心模式**

雖然大部分的 Windows 應用程式執行的安全性部分的使用者，他們開始，這不正確的服務。 當使用者開始電腦服務控制器是開始使用很多的 Windows 服務，例如網路與列印服務。 這些服務是本機服務或本機系統可能會執行，並執行一個人性化使用者登出之後可能繼續。

> [!NOTE]
> 在安全性稱為 [本機系統（系統）、網路的服務或本機服務的環境中通常會執行的服務。  Windows Server 2008 R2 推出的服務執行在受管理的服務帳號的網域原則。

開始之前服務，服務控制器使用登入帳號，指定的服務，然後展示 LSA 驗證服務的認證。 Windows 服務實作程式設計介面服務控制器管理員可控制服務使用。 當系統開始或手動服務控制項程式，可以自動開始 Windows 服務。 例如 Windows client 電腦加入網域，在電腦上的 messenger 服務連接至網域控制站和開啟它的安全的通道。 若要取得驗證的連接，請服務必須遠端電腦的本機安全性授權單位 (LSA) 信任的憑證。 當與其他網路中電腦的通訊，LSA 使用認證本機電腦的網域帳號，為所有其他網路服務和本機系統的安全性環境中執行的服務。 服務，不需要向 LSA 認證執行系統本機電腦上。

檔案 Ksecdd.sys 管理這些認證會加密及使用 LSA 本機程序呼叫。 檔案類型是磁碟機（驅動程式），以及為核心模式安全性支援提供者 (SSP)，在指定的版本中稱為**適用於**清單本主題的開頭，FIPS 140-2 層級 1 相容。

核心模式擁有完整存取權的電腦的硬體及系統資源。 使用者模式服務和應用程式存取的作業系統，它們不應該存取重要的區域，就會停止核心模式。

## <a name="BKMK_LSA"></a>本機安全性授權
本機安全性授權單位 (LSA) 是受保護的系統處理程序的驗證並登入本機電腦的使用者。 此外，LSA 維護的相關資訊各個層面本機安全性在電腦上（這些層面統稱為本機安全性原則），並提供各種不同名稱和安全性識別碼 (Sid) 翻譯服務。 安全性系統處理程序本機安全性授權單位伺服器服務 (LSASS)，記錄的安全性原則和作用中的電腦系統帳號。

LSA 驗證依據發行帳號下列兩個實體的使用者身分：

-   **本機安全性授權單位。** LSA 可以檢查位於該相同電腦的安全性帳號 Manager（坡）資料庫，以驗證使用者的資訊。 帳號本機使用者和群組區域的相關資訊，可以將任何工作站或成員伺服器。 不過，下列帳號可用於存取只該工作站或電腦。

-   **安全性授權單位本機網域或信任的網域。** LSA 連絡人的實體發行 account 和要求驗證帳號，並要求源自 account 擁有者。

本機安全性授權單位子系統服務 (LSASS) 會儲存在記憶體中的認證，代表使用者的使用中視窗工作階段。 儲存的認證，讓使用者順暢地進行存取網路資源，例如檔案共用、Exchange Server 信箱及 SharePoint 網站，不需要重新輸入認證為每個遠端服務。

LSASS 可以儲存認證多個形式，包括：

-   加密反轉純文字

-   Kerberos 門票（票證授與門票 (Tgt)，服務票證）

-   NT hash

-   Hash 區域網路管理員 (LM)

如果使用者登入 windows 使用智慧卡，LSASS 不會儲存純文字密碼，但儲存 account 和智慧卡的 pin 碼純文字對應 NT hash 值。 如果 account 屬性可以進行所需的互動式登入智慧卡，隨機 NT hash 值是自動因帳號，而不是原始湊密碼。 密碼湊所自動屬性設時不會變更。

如果使用者登入 windows 相容的區域網路管理員 (LM) hashes 密碼與電腦，此 authenticator 在於記憶體。

儲存在記憶體中純文字憑證的無法停用，即使它們需要 credential 提供者已停用。

儲存的認證會直接相關聯的本機安全性授權單位子系統服務 (LSASS) 登入工作階段已經開始在最後一個之後重新開機和尚未關閉。 例如，LSA 工作階段使用儲存 LSA 認證建立時的使用者，執行下列其中一項：

-   登入本機工作階段或遠端桌面通訊協定 (RDP) 的電腦上的工作階段

-   執行的工作，使用**RunAs**選項

-   在電腦上執行的作用中的 Windows 服務

-   會執行排定的工作或批次工作

-   使用遠端系統管理工具，在本機電腦上執行的工作

在有時 LSA 機密資料的秘密的資料，只系統 account 處理程序可以存取的項目，會儲存在硬碟上。 這些機密部分的認證，必須重新開機後, 持續，其儲存在硬碟磁碟機加密表單。 可能會包含儲存為 LSA 機密認證：

-   適用於電腦的 Active Directory Domain Services (AD DS) account 密碼

-   已在電腦的 Windows 服務的密碼

-   設定排定的工作的密碼

-   密碼 IIS 應用程式集區與網站

-   Microsoft 帳號的密碼

Client 作業系統引進了 Windows 8.1 中，提供額外 LSA 避免朗讀記憶體和注入由未受保護的處理程序的程式碼保護。 這項保護增加安全性 LSA 儲存和管理的認證。

如需有關這些額外的保護，請查看[設定額外的 LSA 保護](../credentials-protection-and-management/configuring-additional-lsa-protection.md)。

## <a name="BKMK_CachedCredentialsAndValidation"></a>快取的認證與驗證
驗證機制依賴一次登入的認證的簡報。 不過，當電腦中斷網域控制站使用者簡報網域認證，Windows 會使用的程序的快取的認證驗證機制中。

每次使用者網域，登入 Windows 快取提供的認證，並將它們儲存在作業系統登錄中的安全性區。

快取的憑證的使用者可以登入網域成員不連接到網域控制站在這個網域中。


## <a name="BKMK_CredentialStorageAndValidation"></a>憑證存放區與驗證
它並不一定需要使用一組認證存取不同的資源。 例如系統管理員可能會想要使用系統除了使用者的認證時存取遠端伺服器。 同樣地，如果使用者存取外部資源，例如銀行帳號，他只能使用不同的網域認證認證。 下列章節描述認證新版的 Windows 作業系統和 Windows Vista 和 Windows XP 作業系統的管理不同。

### <a name="remote-logon-credential-processes"></a>登入遠端 credential 處理程序
遠端桌面通訊協定 (RDP) 管理使用遠端桌面 Client，在 Windows 8 來連接遠端電腦的使用者的認證。 純文字形式認證會傳送至目標主機位置主機嘗試執行驗證程序，如果成功，連接使用者允許資源。 RDP 不會將認證儲存在 client，但使用者的網域認證儲存在 LSASS。

限制的管理模式引進了 Windows Server 2012 R2 和 Windows 8.1 中，提供額外的安全性，登入遠端案例。 這種遠端桌面模式，會導致 client 應用程式執行網路登入挑戰回應 NT 單向函式 (NTOWF) 或驗證遠端主機時，使用 Kerberos 服務票證。 系統管理員已之後，系統管理員會不需要的各自 account 認證 LSASS 中因為他們已不提供給遠端主機。 而是系統管理員必須電腦 account 認證工作階段。 系統管理員認證不提供給遠端主機，以便為電腦 account 執行動作。 資源也是電腦帳號，及系統管理員也無法存取使用自己 account 資源。

### <a name="automatic-restart-sign-on-credential-process"></a>自動重新登入認證程序
當使用者登入時在 Windows 8.1 的裝置上時，LSA 儲存加密記憶體只有 LSASS.exe 可以存取的使用者的認證。 Windows Update 自動重新開機，而使用者卡時，使用這些認證設定自動登入的使用者。

在重新開機，使用者會自動透過自動登入機制，登入，然後電腦此外鎖定保護使用者的工作階段。 鎖定時車載機起始透過 Winlogon 而 LSA 來管理 credential 完成。 來自動登入，鎖定使用者的工作階段主機使用者的鎖定畫面應用程式是重新啟動和可用。

如需 ARSO 的詳細資訊，請查看[Winlogon 自動重新登入和 #40;ARSO 與 #41;](winlogon-automatic-restart-sign-on-arso.md).

### <a name="stored-user-names-and-passwords-in-windows-vista-and-windows-xp"></a>已儲存的使用者名稱和密碼的 Windows Vista 和 Windows XP
Windows Server 2008、Windows Server 2003、Windows Vista 和 Windows XP 中，**儲存的使用者名稱和密碼**在 [控制台] 中簡化管理，使用多個設定的登入認證，包括 x.509 搭配智慧卡，以及 Windows Live 認證（現在稱為 Microsoft account）。 需要之前儲存認證部分的使用者的個人檔案。 這個動作會增加-資源為基礎的安全性確保，如果受到危害的密碼，它會不會影響所有安全性。

使用者登入，並嘗試存取其他受密碼保護的資源，例如伺服器上的共用之後，如果使用者的預設登入認證不足存取，**儲存的使用者名稱和密碼**會查詢。 如果其他認證正確的登入資訊儲存在**儲存的使用者名稱和密碼**，這些認證會用來存取。 否則，使用者會提供新的憑證，可以儲存的重複使用，稍後再登入活動中或後續工作階段期間提示。

適用於以下限制︰

-   如果**儲存的使用者名稱和密碼**包含認證無效或不正確的遭拒特定的資源，存取的資源，和**儲存的使用者名稱和密碼**對話方塊中未顯示。

-   **儲存的使用者名稱和密碼**儲存認證的 NTLM，Kerberos 通訊協定，僅限 Microsoft account (前身為 Windows Live ID)，並驗證安全通訊端層 (SSL)。 某些版本的 Internet Explorer 維護基本驗證他們自己的快取。

這些認證會變成 \Documents 和您 Data\Microsoft\Credentials directory 使用者的本機的個人檔案已加密的一部分。 因此，這些認證可以將他到的使用者如果使用者的網路原則支援漫遊使用者設定檔。 不過，如果使用者有複本**儲存的使用者名稱和密碼**在兩個不同的電腦和變更的其中一部電腦上的資源相關聯的認證變更未傳送至**儲存的使用者名稱和密碼**在第二部電腦上。

### <a name="windows-vault-and-credential-manager"></a>Windows 保存庫和認證管理員
認證管理員已在 Windows Server 2008 R2 和 Windows 7 中引進了做為儲存及管理使用者名稱和密碼一個 [控制台] 的功能。 認證管理員可讓使用者的認證相關的其他系統和網站儲存在安全的 Windows 保存庫中。 某些版本的 Internet Explorer 會使用此功能的驗證網站。

使用「認證管理員認證管理受本機電腦上的使用者。 使用者可以儲存，並從支援的瀏覽器，並讓它方便時所需下列資源來登入 Windows 應用程式認證。 特殊加密的資料夾中儲存認證使用者的設定檔在電腦上。 支援的網頁瀏覽器與應用程式，例如（關聯認證管理員 Api)，這項功能的應用程式可以在登入時展示到其他電腦及網站正確的認證。

當網站、應用程式或透過 NTLM 或 Kerberos 通訊協定的另一部電腦要求驗證，會出現一個對話方塊中，選取 [**更新預設認證**或**儲存密碼**核取方塊。 支援「認證管理員 Api 的應用程式，也可讓使用者儲存在本機認證此對話方塊。 如果使用者選取**[儲存密碼**核取方塊，認證管理員會的使用者的使用者名稱、密碼、驗證服務使用中的和相關的資訊。

下一次使用該服務，則認證管理員會自動提供的認證，就會儲存在 Windows 保存庫中。 如果無法接受，使用者會提示正確存取的資訊。 如果存取授與的新的認證，認證管理員覆寫新前認證，然後將新認證儲存在 Windows 保存庫。

## <a name="BKMK_SAM"></a>安全性帳號管理員資料庫
安全性帳號 Manager（坡）是資料庫儲存帳號本機使用者和群組。 出現在每個 Windows 作業系統中。不過，當您的電腦已經加入網域，Active Directory 管理網域帳號 Active Directory 網域中。

例如 client 電腦執行的 Windows 作業系統網路網域中加入的網域控制站的通訊，即使在不人性化使用者登入。 若要開始進行通訊，電腦必須使用帳號網域中。 接受電腦的通訊前, 網域控制站 LSA 驗證電腦的身分，並再建構電腦的安全性操作人性化安全性主體一樣。 本文中的安全性定義特定電腦或使用者、服務或網路上的電腦上的身分和使用者或服務的功能。 例如，包含中的安全性層級的存取權杖定義可以存取的資源（例如共用檔案或印表機）和當事人-使用者、電腦或服務的可執行的動作（例如朗讀、寫入或修改）資源。

使用者或電腦的安全性操作到另一個，例如使用者登入時伺服器或以外的使用者自己的主要工作站工作站會從某部電腦。 它也會從一個工作階段到另一個，例如時，系統管理員的身分修改使用者的權利和權限。 此外的安全性層級通常是不同的使用者或電腦操作單獨，在網路，或在 Active Directory domain 時。

## <a name="BKMK_LocalDomainsAndTrustedDomains"></a>本機網域和受信任的網域
信任的網域兩個之間時，每個網域驗證機制需依賴的來自其他網域驗證有效性。 信任藉由驗證連入驗證要求提供控制的存取共用（信任的網域）資源網域中的資源協助來自信任的授權單位（受信任的網域）。 如此一來，信任做為只讓橋接器已驗證網域之間驗證要求出差。

如何特定信任通過驗證要求的設定方式而定。 藉由提供給其他網域中的資源的存取權的每個網域可以單向提供存取來自受信任的網域信任的網域中的資源或雙向，信任關係。 信任的也轉移，此時信任存在，只會之間的兩個信任合作夥伴網域，或轉移，此時信任自動延伸到任何其他合作夥伴之一信任的網域。

適用於相關驗證網域和森林信任關係的相關資訊，請查看[委派驗證和信任關係](https://technet.microsoft.com/library/dn169022.aspx)。

## <a name="BKMK_CertificatesInWindowsAuthentication"></a>在 Windows 驗證憑證
公開基礎結構 (PKI) 是組合軟體、加密技術、處理程序，並讓它通訊和商務交易安全公司的服務。 安全通訊和商務交易 PKI 的能力為基礎的受信任的資源驗證的使用者與數位憑證交換。

數位憑證是電子文件，包含所屬的實體、發行實體、唯一的序號或其他獨特的驗證，發行到期日，並數位指紋相關資訊。

驗證是判斷是否遠端主機可信任的程序。 若要建立可信度，遠端主機必須提供接受驗證憑證。

遠端伺服器的憑證授權單位取得憑證建立彼此。 CA 接下來，已從較高的授權，建立一連串信任的憑證。 若要判斷是否為信任的憑證，應用程式必須判斷根加拿大的身分，並再判斷是否信任。

同樣地，在本機電腦的主機的遠端必須判斷是否真確提出的使用者或應用程式的憑證。 透過在 Active Directory 中的憑證存放區的真確性的本機登入本機電腦上、網路，或網域評估透過 LSA 和 SSPI 使用者提出的憑證。

製作憑證、驗證資料通過製作訊息摘要 hash 演算法，例如安全 Hash 演算法 1 (SHA1)。 藉由寄件者私密金鑰證明摘要訊息由寄件者然後數位簽章訊息摘要。

> [!NOTE]
> SHA1 是 Windows 7 和 Windows Vista 中的預設值，但已變更為 SHA2 Windows 8 中。

**智慧卡驗證**

智慧卡技術是憑證式驗證的範例。 網路使用智慧卡來登入提供有力的驗證，因為它會使用密碼編譯架構的驗證並的擁有權校正驗證使用者網域時。 Active Directory 憑證 Services (AD CS) 提供密碼編譯型驗證透過發行的每個智慧卡憑證登入。

適用於驗證智慧卡的相關資訊，請查看[Windows 智慧卡技術參考](https://technet.microsoft.com/library/ff404297.aspx)。

Windows 8 中引進 virtual 智慧卡技術。 它會儲存在電腦的智慧卡上的憑證，然後使用裝置的竄改信賴平台模組 (TPM) 安全性晶片來保護它。 如此一來，電腦會成為智慧卡，必須接收使用者的 pin 碼以驗證。

**遠端和 wireless 驗證**

遠端和 wireless 網路驗證是另一個用於驗證憑證的技術。 伺服器 virtual 私人網路與網際網路驗證服務 (IAS) 使用最具擴充性驗證通訊協定傳輸層級安全性 (EAP-TLS)、受保護延伸驗證通訊協定 (PEAP) 或網際網路通訊協定 (IPsec) 的安全性憑證驗證執行許多類型的網路存取權，包括 virtual 私人網路 (VPN) 和 wireless 連接。

如憑證驗證網路中相關資訊，請查看[網路存取驗證，以及憑證](https://technet.microsoft.com/library/cc759575(WS.10).aspx)。

## <a name="BKMK_SeeAlso"></a>也了
[Windows 驗證概念](https://technet.microsoft.com/library/d169018.aspx)


