---
title: 作為
description: '適用於 Windows 命令主題 * * *- '
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: manage-windows-commands
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: e275726c-035f-4a74-8062-013c37f5ded1
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: c8764887794857ae56b7c1a3bda656ece18c117f
ms.sourcegitcommit: eaf071249b6eb6b1a758b38579a2d87710abfb54
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/31/2019
ms.locfileid: "66439208"
---
# <a name="for"></a>作為



執行指定的命令，針對每個檔案中的一組檔案。

如需如何使用此命令的範例，請參閱[範例](#BKMK_examples)。

## <a name="syntax"></a>語法

```
for {%%|%}<Variable> in (<Set>) do <Command> [<CommandLineOptions>]
```

## <a name="parameters"></a>參數

|參數|描述|
|---------|-----------|
|{%%\|%}\<變數 >|必要。 表示可置換的參數。 使用單一的百分比符號 ( **%** ) 以實現**如**命令在命令提示字元。 使用雙百分比符號 ( **%%** ) 以實現**如**命令批次檔內。 變數是區分大小寫，而且它們必須使用來表示的字母值這類 **%A**， **%B**，或 **%C**。|
|(\<設定 >)|必要。 指定一或多個檔案、 目錄或文字字串或在其上執行命令的值的範圍。 仍需要括號。|
|\<命令 >|必要。 指定您想要在每個檔案、 目錄或文字字串，或在這個範圍中所包含的值，請執行縮小命令*設定*。|
|\<CommandLineOptions>|指定您想要使用指定的命令與任何命令列選項。|
|/?|在命令提示字元顯示說明。|

## <a name="remarks"></a>備註

- 使用**的**

  您可以使用**針對**命令批次檔內，或直接從命令提示字元。
- 使用批次參數

  下列屬性套用至**針對**命令：  
  - **For** siguiente reemplaza **%** <em>變數</em>或是 **%%** <em>變數</em>與指定的命令處理的所有檔案之前指定集合中每個文字字串。
  - 變數名稱會區分大小寫、 全域和不超過 52 可使用一次。
  - 若要避免混淆在一起的批次參數 **%0**透過 **%9**，您可以使用的任何字元*變數*除了數字 0 到 9。 如需簡單批次檔，單一字元這類 **%%** 運作。
  - 您可以使用多個值*變數*區別不同的可取代變數的複雜的批次檔中。
- 指定檔案的群組

  *設定*參數可代表一組檔案或數個檔案群組。 您可以使用萬用字元 ( **&#42;** 並 **？** ) 指定的檔案設定。 有效的檔案集如下：  
  ```
  (*.doc) 
  (*.doc *.txt *.me)
  (jan*.doc jan*.rpt feb*.doc feb*.rpt)
  (ar??1991.* ap??1991.*)
  ```  
  當您使用**for**命令時中的第一個值*設定*取代 **%** <em>變數</em>或 **%%** <em>變數</em>，然後再指定的命令處理這個值。 這會繼續直到所有檔案 （或檔案群組） 對應至*設定*處理值。
- 使用**中**並**請勿**關鍵字

  **中**並**請勿**不是參數，但您必須將其用於**的**。 如果您省略這些關鍵字之一，就會出現錯誤訊息。
- 使用其他形式的**的**

  如果已啟用命令擴充功能 （也就是預設值），下列額外的形式**針對**支援：  
  - 只針對目錄

    如果*設定*包含萬用字元 ( **&#42;** 或是**嗎？** )，指定*命令*會針對每個目錄 （而不是一組執行指定的目錄中的檔案） 的相符*設定*。

    其語法為：  
    ```
    for /d {%%|%}<Variable> in (<Set>) do <Command> [<CommandLineOptions>] 
    ```  
  - Recursive

    已在進行 root 破解的樹狀目錄會逐步引導*磁碟機*:*路徑*，並執行**如**樹狀結構的每個目錄中的陳述式。 如果未不指定任何目錄後 **/r**，目前的目錄做為目錄的根目錄。 如果*設定*是只是單一句點 （.）、 它只會列舉目錄樹狀結構。

    其語法為：  
    ```
    for /r [[<Drive>:]<Path>] {%%|%}<Variable> in (<Set>) do <Command> [<CommandLineOptions>]
    ```  
  - 逐一查看值的範圍

    可用於反覆的變數設定的起始值 (*開始*#)，然後逐步執行設定範圍的值之前的值超過集合的結束值 (*結束*#)。 **/l**會執行比較來反覆*開始*使用 #*結束*#。 如果*開始*# 是小於*結束*# 會執行命令。 當反覆變數超過*結束*#，命令殼層結束迴圈。 您也可以使用負*步驟*# 逐步遞減值的範圍。 例如，(1,1,5) 產生序列 1 2 3 4 5 和 (5，-1，1) 會產生 5 4 3 2 1 的順序。

    其語法為：  
    ```
    for /l {%%|%}<Variable> in (<Start#>,<Step#>,<End#>) do <Command> [<CommandLineOptions>]
    ```  
  - 逐一查看和檔案剖析

    使用剖析命令輸出中處理程序、 字串和檔案內容的檔案。  使用反覆的變數來定義的內容或您想要檢查的字串，並使用各種*ParsingKeywords*若要進一步修改 剖析選項。  使用*ParsingKeywords* k 選項指定應該以反覆的變數方式傳遞的權杖。 請注意，當 [權杖] 選項，若不使用 **/f**僅會檢查第一個語彙基元。

    剖析檔案包含讀取輸出、 字串或檔案內容，然後分成個別的文字行，並為零或多個語彙基元剖析每一行。 **針對**反覆的變數值設定為語彙基元，然後呼叫迴圈。 根據預設， **/f**從每個檔案的每一行，傳遞第一個空白分隔權杖。 空白行會略過。

    的語法為：  
    ```
    for /f ["<ParsingKeywords>"] {%%|%}<Variable> in (<Set>) do <Command> [<CommandLineOptions>]
    for /f ["<ParsingKeywords>"] {%%|%}<Variable> in ("<LiteralString>") do <Command> [<CommandLineOptions>]
    for /f ["<ParsingKeywords>"] {%%|%}<Variable> in ('<Command>') do <Command> [<CommandLineOptions>]
    ```  
    *設定*引數會指定一或多個檔案名稱。 開啟、 讀取和處理，再移至下一個檔案中的每個檔案*設定*。 若要覆寫預設剖析行為，請指定*ParsingKeywords*。 這是加上引號的字串，其中包含一或多個關鍵字，以指定不同的剖析選項。

    如果您使用**usebackq**選項，請使用下列語法的其中一個：  
    ```
    for /f ["usebackq <ParsingKeywords>"] {%%|%}<Variable> in ("<Set>") do <Command> [<CommandLineOptions>]
    for /f ["usebackq <ParsingKeywords>"] {%%|%}<Variable> in ('<LiteralString>') do <Command> [<CommandLineOptions>]
    for /f ["usebackq <ParsingKeywords>"] {%%|%}<Variable> in (`<Command>`) do <Command> [<CommandLineOptions>]
    ```  
    下表列出可用於剖析關鍵字*ParsingKeywords*。  

    |      關鍵字      |                                                                                                                                                                                                          描述                                                                                                                                                                                                          |
    |-------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    |     eol=\<c>      |                                                                                                                                                                                   指定行尾的字元 （只是一個字元）。                                                                                                                                                                                    |
    |     skip=\<N>     |                                                                                                                                                                              指定要在檔案開頭要略過行的數。                                                                                                                                                                              |
    |   delims=\<xxx>   |                                                                                                                                                                     指定的分隔符號集。 這會取代預設分隔符號集的空間和索引標籤。                                                                                                                                                                      |
    | tokens=\<X,Y,M–N> | 指定要傳遞至每一行的語彙基元**針對**迴圈的每個反覆項目。 如此一來，會配置額外的變數名稱。 *M*–*N*指定為範圍，從*M*透過第*N*個語彙基元。 如果最後一個字元**語彙基元 =** 字串是星號 ( **&#42;** )，會配置額外的變數，和剖析的最後一個語彙基元之後收到該行的其餘文字。 |
    |     usebackq      |                                                                                             指定要： 執行後加上引號的字串，做為命令、 使用單引號字串常值的字串，或長檔名。 包含空格，可讓在檔名 *\<設定\>* 至每個括住雙引號。                                                                                              |


  - 變數替代

    下表列出選擇性的語法 (適用於任何變數**我**)。  

    |修飾詞的變數|描述|
    |----------------------|-----------|
    |%~I|展開 **%I**以移除任何周圍的引號 ("")。|
    |%~fI|展開 **%I**的完整的路徑名稱。|
    |%~dI|展開 **%I**到磁碟機代號。|
    |%~pI|展開 **%I**只的路徑。|
    |%~nI|展開 **%I**為檔案名稱。|
    |%~xI|展開 **%I**副檔名只。|
    |%~sI|展開以包含僅短檔名的路徑。|
    |%~aI|展開 **%I**檔案的檔案屬性。|
    |%~tI|展開 **%I**的日期和時間的檔案。|
    |%~zI|展開 **%I**檔案的大小。|
    |%~$PATH:I|搜尋路徑環境變數中所列的目錄，並展開 **%I**找到的第一個目錄的完整名稱。 如果未定義的環境變數的名稱，或搜尋找不到檔案，這個修飾詞會展開為空字串。|

    下表列出可用來取得複合結果的修飾詞組合。  

    |結合的修飾詞具有變數。|描述|
    |--------------------------------|-----------|
    |%~dpI|展開 **%I**到磁碟機代號及路徑只。|
    |%~nxI|展開 **%I**檔案名稱與僅擴充。|
    |%~fsI|展開 **%I**簡短只具有名稱為完整路徑名稱。|
    |%~dp$PATH:I|搜尋會列出的目錄中的 PATH 環境變數 **%I** ，並展開至磁碟機代號及路徑的第一個找到。|
    |%~ftzaI|展開 **%I**至輸出行類似**dir**。|

    在上述範例中，您可以取代 **%I**和其他有效的值的路徑。 有效**for**變數的名稱會終止 **%~** 語法。

    使用大寫的變數名稱，例如 **%I**，您可以讓您的程式碼更容易閱讀，並避免混淆在一起的修飾詞不區分大小寫。
- 剖析字串

  您可以使用 **/f**剖析立即的字串上的邏輯，藉由包裝 *\<LiteralString\>* 中： 雙引號括住 (*沒有*"usebackq") 或單引號括住 (*與*"usebackq 」)，例如 ("MyString") 或 ('MyString')。 *\<LiteralString\>* 會被視為單行中輸入的檔案。 剖析時 *\<LiteralString\>* 雙引號括住命令符號 (例如 **\\ \& \| \> \< \^** ) 會被視為一般字元。
- 剖析的輸出

  您可以使用 **/f**命令來剖析命令的輸出放在後引號 *\<命令\>* 括號之間。 它會被視為會傳遞至子系 Cmd.exe 命令列。 輸出會擷取到記憶體，並剖析如同它是一個檔案。

## <a name="BKMK_examples"></a>範例

若要使用**針對**批次檔，使用下列語法：
```
for {%%|%}<Variable> in (<Set>) do <Command> [<CommandLineOptions>]
```
若要顯示在目前的目錄有使用可取代變數的副檔名為.doc 或.txt 的所有檔案的內容 **%f**，型別：
```
for %f in (*.doc *.txt) do type %f 
```
在上述範例中，副檔名為.doc 或.txt 目前目錄中的每個檔案用來替代 **%f**變數之前會顯示每個檔案的內容。 若要使用此命令批次檔中，將所有 **%f**具有**s'。%%1**。 否則，會忽略此變數，並會顯示錯誤訊息。

若要剖析檔案，並忽略註解行，型別：
```
for /f "eol=; tokens=2,3* delims=," %i in (myfile.txt) do @echo %i %j %k
```
此命令會剖析 Myfile.txt 中的每一行。 它會忽略以分號為開頭的行，並將第二個和第三個語彙基元傳遞至每一行**針對**主體 （權杖以逗號或空格分隔）。 主體**針對**陳述式會參考 **%i**以取得第二個語彙基元， **%j**取得第三個權杖，和 **%k**取得所有剩餘的語彙基元。 如果您提供的檔案名稱包含空格，請使用引號括住的文字 （例如，「 檔案名稱 」）。 若要使用引號，您必須使用**usebackq**。 否則，引號會解譯為定義要剖析的常值字串。

**%i**在中明確宣告**如**陳述式。 **%j**並 **%k**會以隱含方式宣告可透過**權杖 =** 。 您可以使用**語彙基元 =** 來指定最多 26 的語彙基元，前提是它不會造成宣告變數高於字母"z"或"Z"。

下列範例會列舉在目前的環境中的環境變數名稱。 若要剖析命令的輸出放*設定*括號之間輸入：
```
for /f "usebackq delims==" %i in ('set') do @echo %i 
```

#### <a name="additional-references"></a>其他參考資料

[命令列語法關鍵](command-line-syntax-key.md)
