---
title: set
description: Set 的參考文章，可顯示、設定或移除 cmd.exe 環境變數。
ms.prod: windows-server
ms.technology: manage-windows-commands
ms.topic: article
ms.assetid: 5fdd60d6-addf-4574-8c92-8aa53fa73d76
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 34c8abf01e7dbde7a8f175ac8691e5731a04be45
ms.sourcegitcommit: 3632b72f63fe4e70eea6c2e97f17d54cb49566fd
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/03/2020
ms.locfileid: "87519657"
---
# <a name="set"></a>set

顯示、設定或移除 cmd.exe 的環境變數。 如果使用時不含參數，**設定**會顯示目前的環境變數設定。

## <a name="syntax"></a>語法

```
set [<Variable>=[<String>]]
set [/p] <Variable>=[<PromptString>]
set /a <Variable>=<Expression>
```

### <a name="parameters"></a>參數

|參數|說明|
|---------|-----------|
|\<Variable>|指定要設定或修改的環境變數。|
|\<String>|指定要與指定的環境變數產生關聯的字串。|
|/p|將*變數*的值設定為使用者輸入的一行。|
|\<PromptString>|選擇性。 指定訊息以提示使用者輸入。 這個參數會與 **/p**命令列選項搭配使用。|
|/a|將*字串*設定為已評估的數值運算式。|
|\<Expression>|指定數值運算式。 如需可在*運算式*中使用的有效運算子，請參閱備註。|
|/?|在命令提示字元顯示說明。|

## <a name="remarks"></a>備註

- 已啟用使用**set**搭配命令延伸模組

  當命令延伸模組已啟用（預設值），而且您執行**設定**時，會顯示以該值開頭的所有變數。
- 使用特殊字元

  字元 **<** 、、 **>** 、 **|** **&** **^** 是特殊的命令 shell 字元，它們前面必須加上 escape 字元（ **^** ），或在*字串*中使用時以引號括住（例如， **StringContaining&符號**）。 如果您使用引號來括住包含特殊字元的字串，則引號會被視為環境變數值的一部分。
- 使用環境變數

  使用環境變數來控制某些批次檔和程式的行為，以及控制 Windows 和 MS-DOS 子系統的顯示和運作方式。 **Set**命令通常會在 Autoexec 檔案中用來設定環境變數。
- 顯示目前的環境設定

  當您單獨輸入**set**命令時，會顯示目前的環境設定。 這些設定通常包含 COMSPEC 和 PATH 環境變數，可用來協助尋找磁片上的程式。 Windows 所使用的兩個其他環境變數是 PROMPT 和 DIRCMD。
- 使用參數

  當您指定 [*變數*] 和 [*字串*] 的值時，指定的*變數*值會加入至環境，而*字串*會與該變數相關聯。 如果變數已經存在於環境中，新的字串值會取代舊的字串值。

  如果您僅針對**set**命令指定變數和等號（不含*字串*），則會清除與變數相關聯的*字串*值（如同變數不存在）。
- 使用 **/a**

  下表列出 **/a**支援的運算子（依優先順序的遞減順序）。

  |        運算子         | 已執行操作  |
  |-------------------------|----------------------|
  |           ( )           |       群組       |
  |          ! ~ -          |        一元 (Unary)         |
  |         \* / %          |      算術      |
  |           + -           |      算術      |
  |          << >>          |    邏輯移位     |
  |            &            |     位元 AND      |
  |            ^            | 位元排除 OR |
  |                         |                      |
  | = \*=/=% = + =-= &= ^ = |      = <<= >>=       |
  |            ,            | 運算式分隔符號 |

  如果您使用邏輯（ **&&** 或 **||** ）或模數（ **%** ）運算子，請將運算式字串括在引號中。 運算式中的任何非數值字串都會被視為環境變數名稱，而且它們的值會在處理之前轉換成數位。 如果您指定目前環境中未定義的環境變數名稱，則會配置零值，這可讓您以環境變數值執行算術，而不需要使用% 來取得值。

  如果您從命令腳本外的命令列執行**set/a** ，它會顯示運算式的最後一個值。

  數值是十進位數，除非前面加上0×的十六進位數位，或為0（代表八進位數位）。 因此，0×12與18相同，這與022相同。
- 支援延遲的環境變數擴充

  延遲的環境變數擴充支援預設為停用，但您可以使用**cmd/v**來啟用或停用它。
- 使用命令延伸模組

  當命令延伸模組已啟用（預設值），而且您單獨執行**set**時，它會顯示所有目前的環境變數。 如果您使用值來執行**set** ，它會顯示符合該值的變數。
- 在批次檔中使用**set**

  建立批次檔時，您可以使用**set**來建立變數，然後以使用編號變數 **%0**到 **%9**的相同方式來使用它們。 您也可以使用變數 **%0**到 **%9**作為**set**的輸入。
- 從批次檔呼叫**set**變數

  當您從批次檔呼叫變數值時，請以百分比符號（）括住值 **%** 。 例如，如果您的 batch 程式建立名為波特的環境變數，您可以在命令提示字元中輸入 **% 波特%** ，以使用與波特關聯的字串做為可取代的參數。
- 在修復主控台使用**set**

  具有不同參數的**set**命令可從 [修復主控台] 取得。

## <a name="examples"></a>範例

若要設定名為 TEST ^ 1 的環境變數，請輸入：
```
set testVar=test^^1
```

> [!NOTE]
> **Set**命令會將等號（=）後面的所有內容指派給變數的值。 如果您輸入：
> ```
> set testVar=test^1
> ```
> 您會收到下列結果︰
> ```
> testVar=test^1
> ```
> 若要設定名為 TEST&1 的環境變數，請輸入：
> ```
> set testVar=test^&1
> ```
> 若要設定名為 INCLUDE 的環境變數，讓字串 C:\Inc （磁片磁碟機 C 上的 \Inc 目錄）與其相關聯，請輸入：
> ```
> set include=c:\inc
> ```
> 接著，您可以在批次檔中使用字串 C:\Inc，方法是以百分比符號（）括住名稱 **%** 。 例如，您可以在批次檔中包含下列命令，以便顯示與 INCLUDE 環境變數相關聯的目錄內容：
> ```
> dir %include%
> ```
> 處理此命令時，字串 C:\Inc 會取代 **% include%**。

您也可以在 batch 程式中使用**set** ，將新目錄加入 PATH 環境變數中。 例如：
```
@echo off
rem ADDPATH.BAT adds a new directory
rem to the path environment variable.
set path=%1;%path%
set
```
若要顯示以字母 P 開頭之所有環境變數的清單，請輸入：
```
set p
```

> [!NOTE]
> 此命令需要預設啟用的命令延伸模組。

## <a name="additional-references"></a>其他參考

- [命令列語法關鍵](command-line-syntax-key.md)