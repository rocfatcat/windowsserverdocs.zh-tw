---
title: 效能調整網路介面卡
description: 本主題是部分的 Windows Server 2016 的網路效能子系統調整節目表。
ms.prod: windows-server-threshold
ms.technology: networking
ms.topic: article
ms.assetid: 0b9b0f80-415c-4f5e-8377-c09b51d9c5dd
manager: brianlic
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 1c6d36966ce6e2d407b6568e16946745256ee69b
ms.sourcegitcommit: 19d9da87d87c9eefbca7a3443d2b1df486b0b010
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/28/2018
---
# <a name="performance-tuning-network-adapters"></a>效能調整網路介面卡

>適用於：Windows Server（以每年次管道）、Windows Server 2016

您可以使用此主題效能調整網路介面卡正在執行 Windows Server 2016 的電腦已安裝。

針對下列變數網路介面卡而定，判斷正確的調整設定：

- 網路介面卡和其功能  

- 伺服器所執行的工作負載的類型  

- 伺服器硬體和軟體資源  

- 效能伺服器的目標  

如果您的網路介面卡提供微調選項，您可以將網路達到最佳輸送量根據上述的參數輸送量和資源使用最佳化。  

下列章節描述部分微調選項效能。  

##  <a name="bkmk_offload"></a>讓承載功能

將網路介面卡承載功能是通常有幫助。 有時候，但是網路介面卡足以不處理輸送量高承載功能。

>[!IMPORTANT]
>不要使用承載功能**IPsec 工作卸載**或**TCP Chimney 卸載**。 這些技術已在 Windows Server 2016 取代，可能會影響伺服器與網路的效能。 此外，這些技術可能不支援 Microsoft 未來。

例如，啟用分割承載可以減少某些網路介面卡上的最大持續輸送量因為資源受限的硬體。 不過，如果減少的輸送量不是一項限制，您應該讓承載功能，即使這種類型的網路介面卡。

>[!NOTE]
> 某些網路介面卡需要承載功能將獨立支援傳送和接收的路徑。

##  <a name="bkmk_rss_web"></a>就會收到側邊的網頁伺服器縮放比例 (RSS)

RSS 改善 web 延展性和效能時有較少的網路介面卡比邏輯處理器伺服器上。 當您所有的網路流量後續 RSS 能力的網路介面卡時，來自不同連接網站要求可以同時處理跨不同的 Cpu。

請務必注意，因為 RSS 和超傳輸中的邏輯載入通訊協定 \(HTTP\)、效能可能降低嚴重如果 RSS 功能的網路介面卡接受網路流量有一或多個 RSS 能力的網路介面卡的伺服器上。 這種情況下，您應該使用 RSS 能力網路介面卡或停用的網路介面卡屬性 RSS**進階屬性**索引標籤。若要判斷是否為 RSS 能力的網路介面卡，您可以檢視 RSS 資訊的網路介面卡屬性**進階屬性**索引標籤。

### <a name="rss-profiles-and-rss-queues"></a>RSS 設定檔和 RSS 佇列

預設 RSS 預先定義的個人檔案是作業系統的努馬靜態，可從先前版本變更預設的行為。 若要開始使用 RSS 設定檔，您可以檢視可用的設定檔，以了解時有幫助，以及他們如何套用到您的網路環境和硬體。

例如，如果您開放工作管理員]，並檢視您的伺服器上的邏輯處理器，它們會接收流量充分看起來您可以嘗試增加 RSS 佇列預設為 2 到您的網路介面卡所支援的最大的數目。 您的網路介面卡可能有選項] 來變更的數目 RSS 佇列驅動程式的一部分。

##  <a name="bkmk_resources"></a>增加網路介面卡的資源

允許的資源手動設定，例如接收和傳送緩衝區的網路介面卡，您應該會增加配置的資源。 

某些網路介面卡為他們接收緩衝區低配置節省記憶體的主機。 捨棄的封包和降低的效能會導致低值。 因此，針對接收大量案例中，我們建議您提高接收緩衝到最大值。

>[!NOTE]
>如果網路介面卡未公開手動資源設定，它可能動態設定資源，或資源設定無法變更為修正值。

### <a name="enabling-interrupt-moderation"></a>讓中斷仲裁

若要控制中斷仲裁，某些網路介面卡公開不同中斷仲裁層級，緩衝聯合參數 (有時候分開的傳送和接收緩衝)，或兩者。

您應該會中斷仲裁 cpu 的工作負載，請考慮將和較延遲和更多中斷因為，請考慮增加主機 CPU 節省之間與增加主機 CPU 節省延遲。 如果網路介面卡不會執行中斷仲裁，但它將會公開緩衝聯合、增加聯合緩衝區數目允許更多緩衝區每次傳送或接收，這可以改善效能。

##  <a name="bkmk_low"></a>調整低延遲封包處理效能

許多網路介面卡提供選項來最佳化作業系統導致延遲。 延遲是經過時間處理連入封包網路驅動程式和網路驅動程式，傳送回封包。 這次通常被以毫秒。 相較之下，封包傳輸到長距離的傳輸時間器通常測量（毫秒）\ (重要性順序 larger\)。 這項調整將會減少封包傳輸中所花費的時間。

以下是一些調整建議微秒敏感網路的效能。

- 將電腦的 BIOS 設定為**高效能**，停用 C 狀態。 不過，請注意，此系統和 BIOS 相關，某些系統將提供較高的效能，是否作業系統控制項電源管理。 您可以檢查和調整您的電源管理設定從**設定**或**powercfg**命令。 如需詳細資訊，請查看[Powercfg 命令列選項](https://technet.microsoft.com/library/cc748940.aspx)

- 作業系統的電源管理設定檔為**高效能系統**。 請注意，此將無法正常運作是否已停用作業系統控制項的電源管理設定系統 BIOS。

- 範例、UDP 總和檢查、TCP 總和檢查，以及傳送大型卸載 (LSO) 可讓靜態卸載。

- 如果資料傳輸串流使用多監視器，例如大量多點傳送收到可讓 RSS。

-   停用**中斷仲裁**設定為網路介面卡驅動程式需要的最低可能延遲。 請記住，這可以使用更多的 CPU 時間，以及它所代表折衷。

- 核心是所使用的處理一封包程式（使用者執行緒）與共用 CPU 快取核心處理器處理網路介面卡中斷與 Dpc。 CPU 相關性調整可用於處理程序特定邏輯處理器直接搭配 RSS 設定完成這項工作。 因為 ISR、DPC 及執行緒爭奪核心使用使用相同的核心中斷、DPC，以及使用者模式執行緒表現載入增加更糟效能。

##  <a name="bkmk_smi"></a>系統管理中斷

許多硬體系統使用系統管理中斷 \(SMI\) 各種不同的維護功能，包括的錯誤修正的程式碼 \(ECC\) 記憶體錯誤報告、舊版 USB 相容性、粉絲控制和 BIOS 控制電源管理。 

SMI 是最高優先順序中斷系統上的，並將 CPU 放在了優先執行所有其他活動中斷服務程序，通常會包含在 BIOS 執行時的管理模式。

很抱歉，這可能會導致延遲突然的 100 毫秒或更多。 

如果您需要達到最低延遲，您應該硬體提供者所提供的最低盡降低 SMIs 要求 BIOS 版本。 這些是通常稱為「低延遲 BIOS」或「SMI 免費 BIOS」。 有時候，不可能的硬體的平台完全排除 SMI 活動因為它用來控制基本功能（例如，冷卻愛好者）。

>[!NOTE]
>作業系統可以控制不 SMIs 因為邏輯處理器執行特殊維護模式，可避免作業系統操作。

##  <a name="bkmk_tcp"></a>調整 TCP 效能

 您可以效能調整 TCP 使用下列項目。

###  <a name="bkmk_tcp_params"></a>視窗自動調整 TCP 接收

Windows Server 2008、之前網路堆疊會使用有限連接的整體潛在輸送量修正大小接收端視窗（65535 位元組）。 其中一個最重要的 TCP 堆疊變更為 TCP 收到視窗自動調整。 

當您使用固定的 TCP 收到視窗的大小，您可以計算單一連接的輸送量總計：

**在位元組總達到輸送量 = TCP 收到視窗大小中位元組 \ * (1 月連接秒的延遲)**

例如，達到輸送量總計只有在連接的 10 ms 延遲 51 Mbps \（大型公司網路 infrastructure\ 合理值）。 

自動調整不過，接收端視窗是可調整，與是可以增加符合寄件者的需求。 也可連接至 1 Gbps 連接的完整列率。 網路使用案例，可能會有已受到過去達到輸送量總計的 TCP 連接現在可以完全使用網路。

#### <a name="deprecated-tcp-parameters"></a>過時的 TCP 參數

Windows Server 2003 下列登錄設定不再支援，且會忽略在較新版本。

這些設定都有登錄下列位置：

    ```  
    HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Tcpip\Parameters  
    ```  

- TcpWindowSize

- NumTcbTablePartitions  

- MaxHashTableSize  



###  <a name="bkmk_wfp"></a>Windows 篩選平台

Windows 篩選平台 (WFP)，在 Windows Vista 和 Windows Server 2008 非 Microsoft 獨立軟體廠商 (Isv) 來建立封包處理篩選來提供 Api。 範例包含防火牆軟體和防毒軟體。

>[!NOTE]
>不良的 WFP 篩選會大幅降低伺服器的網路效能。 如需詳細資訊，請查看[移植封包處理驅動程式和 App WFP](https://msdn.microsoft.com/windows/hardware/gg463267.aspx)在 Windows 開發人員中心。


本指南所有主題的連結，會看到[的網路效能子系統調整](net-sub-performance-top.md)。
